<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì‚¬ ê²½ì˜ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        :root { 
            --bg: #fffcfd; --card: #ffffff; --primary: #ffc9d6; --secondary: #d1f2ff; 
            --accent: #e9d5ff; --point: #d3f9d8; --text: #5d5d5d; --danger: #ffb3b3; --fired: #e0e0e0;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* í—¤ë” */
        .header { background: white; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--primary); flex-shrink: 0; }
        .finance-bar { background: #fff; padding: 10px 20px; font-size: 0.85rem; display: flex; justify-content: space-between; border-bottom: 1px solid #eee; color: #ff8fab; font-weight: bold; }
        
        .nav { display: flex; gap: 8px; padding: 10px 15px; background: #fff; border-bottom: 1px solid #eee; overflow-x: auto; }
        .nav button { padding: 10px 18px; border: none; background: #fdfdfd; cursor: pointer; border-radius: 12px; font-weight: bold; color: #aaa; white-space: nowrap; }
        .nav button.active { background: var(--primary); color: white; }

        .main-wrapper { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        @media (min-width: 900px) { .main-wrapper { flex-direction: row; } }
        
        .content-area { flex: 1; padding: 15px; overflow-y: auto; }
        .page { display: none; } .page.active { display: block; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(165px, 1fr)); gap: 12px; }
        
        /* ìºë¦­í„° ì¹´ë“œ */
        .card { background: var(--card); padding: 15px; border-radius: 25px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 2px solid #fff; cursor: pointer; position: relative; transition: 0.2s; }
        .card.fired { background: var(--fired); filter: grayscale(1); opacity: 0.6; cursor: default; }
        .card:hover:not(.fired) { border-color: var(--primary); transform: translateY(-3px); }
        .name-input { border: none; background: transparent; font-weight: bold; font-size: 1.05rem; width: 100%; color: var(--text); outline: none; padding: 2px; }
        .name-input:hover { background: #fff0f3; border-radius: 5px; }

        /* ìŠ¤íƒ¯ */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 0.65rem; margin-top: 10px; }
        .stat-bar { height: 4px; background: #eee; border-radius: 2px; overflow: hidden; margin-top: 2px; }
        .stat-fill { height: 100%; transition: 0.5s; }
        .club-tag { display: inline-block; padding: 2px 8px; border-radius: 20px; background: var(--point); font-size: 0.6rem; margin-top: 5px; font-weight: bold; color: #55a35d; }

        /* ë¡œê·¸ ìŠ¤íƒ€ì¼ ê°•í™” */
        .log-sidebar { background: white; border-left: 1px solid #eee; display: flex; flex-direction: column; width: 100%; height: 300px; }
        @media (min-width: 900px) { .log-sidebar { width: 420px; height: auto; } }
        .log-container { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px; }
        
        .log-entry { padding: 10px; border-radius: 12px; font-size: 0.85rem; background: #fff9fa; border-left: 5px solid var(--primary); animation: slideUp 0.3s ease-out; line-height: 1.4; }
        
        /* ë¡œê·¸ íƒ€ì…ë³„ ìƒ‰ìƒ */
        .log-behavior { color: #888; border-left-color: #eee !important; font-size: 0.8rem; }
        .log-good { border-left-color: #a3e635 !important; font-weight: bold; }
        .log-bad { border-left-color: #fb7185 !important; font-weight: bold; }
        .log-urgent-good { background: #f0fdf4; border-left-color: #22c55e !important; color: #166534; font-weight: bold; border-width: 8px; }
        .log-urgent-bad { background: #fef2f2; border-left-color: #ef4444 !important; color: #991b1b; font-weight: bold; border-width: 8px; }

        .rel-item { background: white; padding: 12px; border-radius: 18px; border-left: 6px solid var(--accent); margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .rel-bad { border-left-color: #ffb3b3; color: #d63031; font-weight: bold; }

        /* ëª¨ë‹¬ */
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.4); z-index: 3000; backdrop-filter: blur(5px); }
        .modal { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; border-radius: 35px; width: 92%; max-width: 420px; }
        select, input[type="text"] { width: 100%; padding: 12px; margin: 8px 0; border-radius: 12px; border: 1px solid #eee; }
        .btn { padding: 14px; border-radius: 15px; border: none; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        .btn-main { background: var(--primary); color: white; }
        @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0; color:var(--primary); font-size:1.1rem;">ğŸ¢ íšŒì‚¬ ê²½ì˜ ì‹œë®¬ë ˆì´ì…˜</h2>
    <div style="display:flex; gap:8px;">
        <button onclick="next()" class="btn" style="margin:0; width:auto; padding:10px 15px; background:var(--secondary);">í•˜ë£¨ ì§„í–‰</button>
        <button id="autoBtn" onclick="toggleAuto()" class="btn" style="margin:0; width:auto; padding:10px 15px; background:var(--primary); color:white;">ìë™ ì‹œì‘</button>
    </div>
</div>

<div class="finance-bar">
    <span>ìê¸ˆ: <span id="mDisp">250,000</span>ì›</span>
    <span>ë‚ ì§œ: Day <span id="dDisp">1</span></span>
</div>

<div class="nav">
    <button id="n-emp" class="active" onclick="tab('emp')">ë©¤ë²„ ê´€ë¦¬</button>
    <button id="n-rel" onclick="tab('rel')">ê´€ê³„/ë™í˜¸íšŒ</button>
    <button id="n-sys" onclick="tab('sys')">ì‹œìŠ¤í…œ</button>
</div>

<div class="main-wrapper">
    <div class="content-area">
        <div id="p-emp" class="page active">
            <div id="eGrid" class="grid"></div>
            <div id="emptyMsg" style="text-align:center; margin-top:100px; color:#ccc;">ì‚¬ì›ì„ ì˜ì…í•˜ê³  'í•˜ë£¨ ì§„í–‰'ì„ ëˆŒëŸ¬ë³´ì„¸ìš”!</div>
        </div>
        <div id="p-rel" class="page"><div id="rList"></div></div>
        <div id="p-sys" class="page">
            <button onclick="saveData('HR')" class="btn">ì¸ì‚¬ ë°ì´í„° ì¶”ì¶œ</button>
            <button onclick="saveData('BIZ')" class="btn" style="background:var(--secondary);">ì¬ë¬´ ë°ì´í„° ì¶”ì¶œ</button>
            <button onclick="location.reload()" class="btn" style="background:var(--danger); color:white;">ê²Œì„ ì´ˆê¸°í™”</button>
        </div>
    </div>
    <div class="log-sidebar">
        <div style="padding:15px; font-weight:bold; color:var(--primary); border-bottom:1px solid #eee; background:#fdfdfd;">ğŸ€ ì‹¤ì‹œê°„ íƒ€ì„ë¼ì¸ (ì´ë²¤íŠ¸ ë¹ˆë„ UP)</div>
        <div id="lBox" class="log-container"></div>
    </div>
</div>

<div id="mOv" class="modal-overlay" onclick="clM()"><div class="modal" onclick="event.stopPropagation()">
    <h3 id="mTitle" style="color:var(--primary); margin:0;">ìƒì„¸ ì •ë³´ ìˆ˜ì •</h3>
    <div style="margin-top:15px;">ì´ë¦„ ìˆ˜ì •: <input type="text" id="editName"></div>
    <div style="padding:15px; background:#fdfafb; border-radius:18px; margin-top:10px;">
        <strong>âš”ï¸ ìŠ¹ì§„ ë°°í‹€ (í•˜ê·¹ìƒ)</strong><br>
        ìƒëŒ€: <select id="btlSel"></select>
        <button onclick="startBattle()" class="btn btn-main">ê²°íˆ¬ ì‹œì‘</button>
    </div>
    <div style="padding:15px; background:#fff5f7; border-radius:18px; margin-top:10px;">
        <strong>ğŸ¤ ê´€ê³„ ê°•ì œ ì„¤ì •</strong><br>
        ëŒ€ìƒ: <select id="relSel"></select>
        íƒ€ì…: <select id="relType"></select>
        <button onclick="manualRel()" class="btn" style="background:#8a70d6; color:white;">ê´€ê³„ í™•ì •</button>
    </div>
    <button onclick="deleteEmp(selId)" class="btn" style="background:var(--danger); color:white; margin-top:15px;">ìˆ˜ë™ í•´ê³ (ì‚­ì œ)</button>
    <button onclick="clM()" class="btn" style="background:#eee;">ë‹«ê¸°</button>
</div></div>

<script>
    let st = { m: 250000, d: 1, e: [], r: {}, over: false };
    const RANKS = ["ì¸í„´", "ì‚¬ì›", "ëŒ€ë¦¬", "ê³¼ì¥", "ì°¨ì¥", "ë¶€ì¥", "ì´ì‚¬", "CEO"];
    const SALARY = [2000, 3800, 6500, 11000, 19000, 35000, 60000, 130000];
    const TRAITS = ["ì²œì¬", "ì›Œì»¤í™€ë¦­", "ì‚¬êµê°€", "ê²Œìœ¼ë¦„", "íŠ¸ëŸ¬ë¸”ë©”ì´ì»¤", "ì•¼ì‹¬ê°€"];
    const RELS = ["ë² í”„", "ë¼ì´ë²Œ", "ë¹„ë°€ì—°ì• ", "í˜ê´€", "ì§ì‚¬ë‘", "ê°€ìŠ¤ë¼ì´íŒ…", "ë©˜í† ë§", "ë¶ˆë¥œ", "ê²½ê³„"];
    const LN = ["ê¹€", "ì´", "ë°•", "ìµœ", "ì •", "ê°•", "ì¡°", "ìœ¤", "ì¥", "ì„"];
    const FN = ["ì•„ì˜", "ë„ì›", "ì¤€ì„œ", "ìˆ˜ì—°", "ì§€í˜¸", "ë‚˜ì€", "ë¯¼ì¤€", "í•˜ë¦°", "ì˜ˆì¤€", "ìœ ì§„"];
    let selId = null, autoInt = null;

    function hire() {
        const name = LN[Math.floor(Math.random()*10)] + FN[Math.floor(Math.random()*10)];
        st.e.push({ id:Date.now()+Math.random(), n:name, rIdx:0, tech:50, sale:50, mtl:50, hp:50, trait:TRAITS[Math.floor(Math.random()*6)], isFired:false, club:null });
        document.getElementById('emptyMsg').style.display = 'none';
        uUI(); log(`ğŸŒ¸ <b>${name}</b>ë‹˜ì´ ì‹ ì…ìœ¼ë¡œ ì±„ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.`, "log-good");
    }

    function next() {
        if(st.over) return;
        st.d++; 
        let rev = 0, exp = 0;
        
        st.e.forEach(e => {
            if(e.isFired) return;
            rev += (e.tech * 1.8) + (e.sale * 2.3);
            exp += SALARY[e.rIdx];

            const roll = Math.random();
            // 1. ì¼ìƒ í–‰ë™ ë¡œê·¸ (ìì£¼ ëœ¸)
            if(roll < 0.15) log(`â˜• <b>${e.n}</b>ë‹˜ì´ ë¯¹ìŠ¤ì»¤í”¼ë¥¼ ë§ˆì‹œë©° ë©ì„ ë•Œë¦½ë‹ˆë‹¤.`, "log-behavior");
            else if(roll < 0.2) log(`ğŸ›‹ï¸ <b>${e.n}</b>ë‹˜ì´ ì ì‹œ íœ´ê²Œì‹¤ì—ì„œ íœ´ì‹ì„ ì·¨í•©ë‹ˆë‹¤.`, "log-behavior");

            // 2. ì„±ê²©/ìŠ¤íƒ¯ ë¡œì§
            if(e.trait === "ì²œì¬" && roll < 0.1) { e.tech += 5; log(`ğŸ’¡ <b>${e.n}</b>ë‹˜ì´ ê¸°ê°€ ë§‰íŒ ì•„ì´ë””ì–´ë¥¼ ëƒˆìŠµë‹ˆë‹¤!`, "log-good"); }
            if(e.trait === "íŠ¸ëŸ¬ë¸”ë©”ì´ì»¤" && roll < 0.08) { st.m -= 10000; log(`ğŸ‘¿ <b>${e.n}</b>ë‹˜ì´ íŒ€ì›ê³¼ ë§ë‹¤íˆ¼ì„ ë²Œì˜€ìŠµë‹ˆë‹¤. (-10,000)`, "log-bad"); }
            
            // 3. ê´€ê³„ ë° ë™í˜¸íšŒ
            if(roll < 0.15) autoRel(e);
            if(e.trait === "ì‚¬êµê°€" && !e.club && roll < 0.05) {
                e.club = ["ë“±ì‚°íšŒ", "ë§›ì§€ë„", "ë³¼ë§í´ëŸ½"][Math.floor(Math.random()*3)];
                log(`ğŸ¨ <b>${e.n}</b>ë‹˜ì´ '${e.club}' ë™í˜¸íšŒë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.`);
            }
            if(e.club) exp += 1500;
        });

        // 4. â˜… ì´ˆê°•ë ¥ íšŒì‚¬ ì´ë²¤íŠ¸ (í™•ë¥  25%) â˜…
        if(Math.random() < 0.25) {
            const evts = [
                {t:"ğŸš€ [íˆ¬ì] ì—”ì ¤ íˆ¬ììë¡œë¶€í„° ê±°ì•¡ì˜ íˆ¬ìë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤!", m:150000, c:"log-urgent-good"},
                {t:"ğŸ’¸ [ì„¸ë¬´] ì„¸ë¬´ ì¡°ì‚¬ ê²°ê³¼ ì„¸ê¸ˆì´ ì¶”ê°€ ì§•ìˆ˜ë©ë‹ˆë‹¤!", m:-70000, c:"log-urgent-bad"},
                {t:"ğŸ’” [ìŠ¤ìº”ë“¤] ì‚¬ë‚´ ë¶ˆë¥œ ì‚¬ì‹¤ì´ ì‚¬ë‚´ ë©”ì‹ ì €ì— í¼ì¡ŒìŠµë‹ˆë‹¤!", m:-50000, c:"log-urgent-bad"},
                {t:"ğŸ’» [í•´í‚¹] ì„œë²„ê°€ ê³µê²©ë°›ì•„ ë³µêµ¬ ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤!", m:-40000, c:"log-urgent-bad"},
                {t:"ğŸŒŸ [ëŒ€ë°•] íšŒì‚¬ ì œí’ˆì´ SNSì—ì„œ ì…ì†Œë¬¸ì„ íƒ”ìŠµë‹ˆë‹¤!", m:80000, c:"log-urgent-good"}
            ];
            const ev = evts[Math.floor(Math.random()*evts.length)];
            st.m += ev.m;
            log(ev.t, ev.c);
        }

        // ì •ì‚° ë° íŒŒì‚°
        st.m = st.m + rev - exp;
        if(st.m < exp) {
            const targets = st.e.filter(x=>!x.isFired).sort((a,b)=>(a.tech+a.sale)-(b.tech+b.sale));
            if(targets[0]) { targets[0].isFired = true; log(`âš ï¸ <b>${targets[0].n}</b>ë‹˜ì´ ìê¸ˆ ë¶€ì¡±ìœ¼ë¡œ íšŒìƒ‰ í•´ê³ ë˜ì—ˆìŠµë‹ˆë‹¤.`, "log-bad"); }
        }
        if(st.m <= 0) { st.over = true; log("âŒ íšŒì‚¬ê°€ íŒŒì‚°í–ˆìŠµë‹ˆë‹¤. ê²Œì„ ì¢…ë£Œ.", "log-urgent-bad"); alert("íŒŒì‚° ì—”ë”©!"); toggleAuto(); }
        uUI();
    }

    function autoRel(p1) {
        const others = st.e.filter(x => x.id !== p1.id && !x.isFired);
        if(others.length > 0) {
            const p2 = others[Math.floor(Math.random()*others.length)];
            const t = RELS[Math.floor(Math.random()*RELS.length)];
            st.r[[p1.id, p2.id].sort().join('-')] = t;
            if(t === "ë¶ˆë¥œ") log(`ğŸ”¥ [ìŠ¤ìº”ë“¤] <b>${p1.n}</b> & <b>${p2.n}</b>ë‹˜ì˜ ì‚¬ì´ê°€ ìˆ˜ìƒí•©ë‹ˆë‹¤.`, "log-bad");
        }
    }

    function uUI() {
        document.getElementById('mDisp').innerText = Math.floor(st.m).toLocaleString();
        document.getElementById('dDisp').innerText = st.d;
        document.getElementById('eGrid').innerHTML = st.e.map(e => `
            <div class="card ${e.isFired?'fired':''}" onclick="opM(${e.id})">
                <small style="color:var(--primary); font-weight:bold;">${RANKS[e.rIdx]}</small>
                <input class="name-input" value="${e.n}" onchange="st.e.find(x=>x.id==${e.id}).n=this.value" onclick="event.stopPropagation()">
                <small style="color:#aaa; display:block;">${e.trait}</small>
                ${e.club ? `<div class="club-tag">${e.club}</div>` : ''}
                <div class="stat-grid">
                    <div>T ${bar(e.tech, 'var(--primary)')}</div><div>S ${bar(e.sale, 'var(--secondary)')}</div>
                    <div>M ${bar(e.mtl, 'var(--accent)')}</div><div>H ${bar(e.hp, 'var(--point)')}</div>
                </div>
            </div>`).join('') + `<div class="card" onclick="hire()" style="border:2px dashed #ddd; display:flex; justify-content:center; align-items:center; color:#ccc; font-weight:bold;">+ ì‚¬ì› ì±„ìš©</div>`;

        let rH = ""; for(let k in st.r) {
            let ids=k.split('-'); let e1=st.e.find(x=>x.id==ids[0]), e2=st.e.find(x=>x.id==ids[1]);
            if(e1 && e2 && !e1.isFired && !e2.isFired) {
                const isAffair = st.r[k] === "ë¶ˆë¥œ";
                rH += `<div class="rel-item ${isAffair?'rel-bad':''}"><b>${e1.n} ï¼† ${e2.n}</b> <span>${st.r[k]}</span></div>`;
            }
        }
        document.getElementById('rList').innerHTML = rH || "ê´€ê³„ ì—†ìŒ";
    }

    function bar(v, c) { return `<div class="stat-bar"><div class="stat-fill" style="width:${Math.min(v,100)}%; background:${c}"></div></div>`; }
    function log(m, c="") { const b = document.getElementById('lBox'); const d = document.createElement('div'); d.className = `log-entry ${c}`; d.innerHTML = `<small>Day ${st.d}</small><br>${m}`; b.appendChild(d); b.scrollTop = b.scrollHeight; }
    function opM(id) { 
        selId=id; const e=st.e.find(x=>x.id===id); if(e.isFired) return; 
        document.getElementById('editName').value=e.n;
        const o = st.e.filter(x=>x.id!==id && !x.isFired).map(x=>`<option value="${x.id}">${x.n}</option>`).join('');
        document.getElementById('btlSel').innerHTML = o; document.getElementById('relSel').innerHTML = o;
        document.getElementById('relType').innerHTML = RELS.map(r=>`<option value="${r}">${r}</option>`).join('');
        document.getElementById('mOv').style.display='block'; 
    }
    function applyEdit() { st.e.find(x=>x.id===selId).n = document.getElementById('editName').value; clM(); uUI(); }
    function clM() { document.getElementById('mOv').style.display='none'; }
    function deleteEmp(id) { st.e = st.e.filter(x=>x.id!==id); clM(); uUI(); log("ğŸš® ìˆ˜ë™ í•´ê³  ì™„ë£Œ."); }
    function startBattle() { 
        let p1=st.e.find(x=>x.id===selId), p2=st.e.find(x=>x.id==document.getElementById('btlSel').value);
        if((p1.tech+p1.sale) > (p2.tech+p2.sale)) { p1.rIdx=Math.min(7, p1.rIdx+1); p2.rIdx=Math.max(0, p2.rIdx-1); log(`âš”ï¸ [ë°°í‹€] <b>${p1.n}</b> ìŠ¹ë¦¬!`, "log-urgent-good"); }
        else { log(`âš”ï¸ [ë°°í‹€] <b>${p1.n}</b> íŒ¨ë°°...`); }
        clM(); uUI(); 
    }
    function manualRel() { st.r[[selId, document.getElementById('relSel').value].sort().join('-')] = document.getElementById('relType').value; clM(); uUI(); log("âœ¨ ê´€ê³„ ì„¤ì • ì™„ë£Œ."); }
    function toggleAuto() { if(autoInt) { clearInterval(autoInt); autoInt=null; document.getElementById('autoBtn').innerText="ìë™ ì‹œì‘"; } else { autoInt=setInterval(next, 1200); document.getElementById('autoBtn').innerText="ì¤‘ì§€"; } }
    function tab(t) { document.querySelectorAll('.page, .nav button').forEach(x=>x.classList.remove('active')); document.getElementById(`p-${t}`).classList.add('active'); document.getElementById(`n-${t}`).classList.add('active'); }
    function saveData(t) { let b=new Blob([JSON.stringify(t==='HR'?st.e:st.m)],{type:'application/json'}); let a=document.createElement('a'); a.href=URL.createObjectURL(b); a.download=`${t}.json`; a.click(); }
    uUI();
</script>
</body>
</html>
